# `--outFile` є ПОГАНОЮ практикою {#outFile}

Це погана ідея використовувати через наступні причини:

* Помилки в часі виконання
* Швидкий компілятор
* Глобальний контекст
* Важко аналізувати
* Важко масштабувати
* `_references`
* Повторне використання коду
* Декілька цільових платформ
* Ізольована компіляція

## Помилки в часі виконання

Якщо ваш код залежить від будь-якого порядку js, ви отримаєте випадкові помилки в часі виконання.

* **спадкування класу може зламатися в часі виконання.**

Розгляньте `foo.ts`:
```ts
class Foo {
    
}
```

і `bar.ts`:
```ts
class Bar extends Foo {
    
}
```

Якщо ви не скомпілюєте його в правильному порядку, наприклад, за алфавітом `tsc bar.ts foo.ts`, код скомпілюється добре, але при виконанні виникне помилка `ReferenceError`.

* **розділення модуля може зламатися в часі виконання.**

Розгляньте `foo.ts`:
```ts
module App {
    export var foo = 123;
}
```
І `bar.ts`:
```ts
module App {
    export var bar = foo + 456;
}
```

Якщо ви не скомпілюєте його в правильному порядку, наприклад, за алфавітом `tsc bar.ts foo.ts`, код скомпілюється добре, але при виконанні *тихо* зламається з `bar`, встановленим на `NaN`.

## Швидкий компілятор
Якщо ви використовуєте `--out`, то окремі файли `.ts` не можуть бути скомпільовані в окремі файли `.js` в ізоляції без непотрібних хаків. `--out` фактично змушує повільну інкрементальну збірку.

Також карти джерел чутливі до позиції та кодуються довжиною, тому більшість карти має бути перебудована при повторній компіляції, якщо ви використовуєте карти джерел (що ви повинні робити!). При високих 10-100 kloc в комбінації це буде повільно.

## Глобальний контекст
Звичайно, ви можете використовувати простори імен, але вони все ще знаходяться на `window`, якщо ви запускаєте їх у браузері. Простори імен - це просто непотрібний обхідний шлях. Крім того, коментарі `/// <reference` вводять глобальний контекст в *ваш код*, який може бути важко підтримувати.

Також, якщо у вашій компанії працює кілька команд, які працюють незалежно, і потім хтось вирішує спробувати інтегрувати дві незалежно написані програми, є висока ймовірність конфлікту імен.

## Важко аналізувати
Ми хочемо надавати більше інструментів аналізу коду. Це буде легше, якщо ви надаєте нам ланцюжок залежностей (неявно там на срібному поднощі за допомогою зовнішніх модулів).

Також не тільки *інструменти розробника* мають важко розуміти код. Наступна людина повинна розуміти багато кодової бази, перш ніж вона почне розуміти, звідки насправді імпортується матеріал. Використання внутрішніх модулів також робить код важким для перегляду в ізоляції, наприклад, на github.

## Важко масштабувати
Це дійсно результат випадкових помилок в часі виконання + все повільніші часи компіляції + складність розуміння чужого коду.

## `_references.ts`
Не підтримується `tsconfig.json`: https://github.com/Microsoft/TypeScript/issues/2472#issuecomment-85330803 Вам доведеться вручну відсортувати масив `files`.

## Повторне використання коду
Якщо ви хочете повторно використовувати частину свого коду в іншому проекті, з усім цим *неявним* управлінням залежностями, буде важко перенести його без можливих помилок в часі виконання.

## Декілька цільових платформ
Також, якщо ви вирішите повторно використовувати свій код для браузера в чомусь на зразок nodejs (наприклад, для *тестування* API), вам доведеться перенести його в систему модулів або придумати потворні хаки, щоб зробити nodejs `global` вашим новим глобальним контекстом (тобто `window`).

## Ізольована компіляція
Файли не можуть бути скомпільовані в ізоляції. Наприклад, розгляньте `a.ts`:
```ts
module M {
  var s = t;
}
```
Буде мати різний вихід залежно від того, чи є `b.ts` наступного вигляду:
```ts
module M {
  export var t = 5;
}
```
або
```ts
var t = 5;
```
Таким чином, `a.ts` [не може бути скомпільований в ізоляції](https://github.com/Microsoft/TypeScript/issues/2715).

## Висновок
`--out` - це насправді робота деякого інструменту збірки. І навіть такий інструмент збірки може скористатися згадками про залежності, наданими зовнішніми модулями. Тому ми рекомендуємо використовувати зовнішні модулі, а потім дозволити інструменту збірки створити для вас один `.js`, якщо ви цього бажаєте.

https://twitter.com/nycdotnet/status/613705850574778368 

![The Bas Signal](https://pbs.twimg.com/media/CIRSOBmWsAQdzvP.jpg)